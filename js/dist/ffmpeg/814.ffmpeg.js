!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.FFmpegWASM=t():e.FFmpegWASM=t()}(self,()=>(()=>{"use strict";const F="https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd/ffmpeg-core.js";var L,e;(e=L=L||{}).LOAD="LOAD",e.EXEC="EXEC",e.WRITE_FILE="WRITE_FILE",e.READ_FILE="READ_FILE",e.DELETE_FILE="DELETE_FILE",e.RENAME="RENAME",e.CREATE_DIR="CREATE_DIR",e.LIST_DIR="LIST_DIR",e.DELETE_DIR="DELETE_DIR",e.ERROR="ERROR",e.DOWNLOAD="DOWNLOAD",e.PROGRESS="PROGRESS",e.LOG="LOG",e.MOUNT="MOUNT",e.UNMOUNT="UNMOUNT";const l=new Error("unknown message type"),g=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),u=(new Error("called FFmpeg.terminate()"),new Error("failed to import ffmpeg-core.js"));let D;return self.onmessage=async({data:{id:t,type:e,data:r}})=>{const a=[];let s;try{if(e!==L.LOAD&&!D)throw g;switch(e){case L.LOAD:s=await(async({coreURL:e,wasmURL:t,workerURL:r})=>{var a=!D;try{e=e||F,importScripts(e)}catch{if(e=e||F.replace("/umd/","/esm/"),self.createFFmpegCore=(await import(e)).default,!self.createFFmpegCore)throw u}var s=e,t=t||e.replace(/.js$/g,".wasm"),r=r||e.replace(/.js$/g,".worker.js");return(D=await self.createFFmpegCore({mainScriptUrlOrBlob:s+"#"+btoa(JSON.stringify({wasmURL:t,workerURL:r}))})).setLogger(e=>self.postMessage({type:L.LOG,data:e})),D.setProgress(e=>self.postMessage({type:L.PROGRESS,data:e})),a})(r);break;case L.EXEC:s=(({args:e,timeout:t=-1})=>{D.setTimeout(t),D.exec(...e);t=D.ret;return D.reset(),t})(r);break;case L.WRITE_FILE:s=({path:m,data:d}=[r][0],D.FS.writeFile(m,d),!0);break;case L.READ_FILE:s=({path:f,encoding:R}=[r][0],D.FS.readFile(f,{encoding:R}));break;case L.DELETE_FILE:s=(p=[r["path"]][0],D.FS.unlink(p),!0);break;case L.RENAME:s=({oldPath:i,newPath:c}=[r][0],D.FS.rename(i,c),!0);break;case L.CREATE_DIR:s=(n=[r["path"]][0],D.FS.mkdir(n),!0);break;case L.LIST_DIR:s=(({path:e})=>{const t=D.FS.readdir(e),r=[];for(const a of t){const t=D.FS.stat(e+"/"+a),s=D.FS.isDir(t.mode);r.push({name:a,isDir:s})}return r})(r);break;case L.DELETE_DIR:s=(E=[r["path"]][0],D.FS.rmdir(E),!0);break;case L.MOUNT:s=(({fsType:e,options:t,mountPoint:r})=>{e=D.FS.filesystems[e];return!!e&&(D.FS.mount(e,t,r),!0)})(r);break;case L.UNMOUNT:s=(o=[r["mountPoint"]][0],D.FS.unmount(o),!0);break;default:throw l}}catch(e){return void self.postMessage({id:t,type:L.ERROR,data:e.toString()})}var o,E,n,i,c,p,f,R,m,d;s instanceof Uint8Array&&a.push(s.buffer),self.postMessage({id:t,type:e,data:s},a)},{}})());